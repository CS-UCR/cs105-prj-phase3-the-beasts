import pandas as pd
import numpy as np
df = pd.read_csv('CS 105 Project.csv')

df = df.set_index(['Year', 'Rank'])

df["Number of Employees"] = df["Number of Employees"].replace({'\,':''}, regex = True)
df["Number of Employees"] = df["Number of Employees"].replace({'\,':''}, regex = True)
df["Number of Employees"] = df["Number of Employees"].fillna(0)
df["Number of Employees"] = df["Number of Employees"].astype(float)

df.loc[df['Change in Rank'] == '-', 'Change in Rank'] = 0
df["Change in Rank"] = df["Change in Rank"].fillna(0)
df["Change in Rank"] = df["Change in Rank"].astype(int)

df["Revenues ($millions)"] = df["Revenues ($millions)"].replace({'\$':''}, regex = True)
df["Revenues ($millions)"] = df["Revenues ($millions)"].replace({'\,':''}, regex = True)
df["Revenues ($millions)"] = df["Revenues ($millions)"].fillna(0)
df["Revenues ($millions)"] = df["Revenues ($millions)"].astype(float)

df["Revenue Change"] = df["Revenue Change"].replace({'\%':''}, regex = True)
df.loc[df['Revenue Change'] == '-', 'Revenue Change'] = 0
df["Revenue Change"] = df["Revenue Change"].fillna(0)
df["Revenue Change"] = df["Revenue Change"].astype(float)

df["Profits ($millions)"] = df["Profits ($millions)"].replace({'\$':''}, regex = True)
df["Profits ($millions)"] = df["Profits ($millions)"].replace({'\,':''}, regex = True)
df.loc[df['Profits ($millions)'] == '-', 'Profits ($millions)'] = 0
df["Profits ($millions)"] = df["Profits ($millions)"].fillna(0)
df["Profits ($millions)"] = df["Profits ($millions)"].astype(float)

df["Profit Change"] = df["Profit Change"].replace({'\%':''}, regex = True)
df.loc[df['Profit Change'] == '-', 'Profit Change'] = 0
df["Profit Change"] = df["Profit Change"].fillna(0)
df["Profit Change"] = df["Profit Change"].astype(float)

df["Assets ($millions)"] = df["Assets ($millions)"].replace({'\$':''}, regex = True)
df["Assets ($millions)"] = df["Assets ($millions)"].replace({'\,':''}, regex = True)
df["Assets ($millions)"] = df["Assets ($millions)"].fillna(0)
df["Assets ($millions)"] = df["Assets ($millions)"].astype(float)

df["Market Value As of 3/29/19 ($m)"] = df["Market Value As of 3/29/19 ($m)"].replace({'\$':''}, regex = True)
df["Market Value As of 3/29/19 ($m)"] = df["Market Value As of 3/29/19 ($m)"].replace({'\,':''}, regex = True)
df.loc[df['Market Value As of 3/29/19 ($m)'] == '-', 'Market Value As of 3/29/19 ($m)'] = 0
df["Market Value As of 3/29/19 ($m)"] = df["Market Value As of 3/29/19 ($m)"].fillna(0)
df["Market Value As of 3/29/19 ($m)"] = df["Market Value As of 3/29/19 ($m)"].astype(float)

df.head()
